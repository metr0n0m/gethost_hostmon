-- Runtime tables for modular management and app-level settings

CREATE TABLE IF NOT EXISTS modules (
    id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL UNIQUE,
    enabled TINYINT(1) NOT NULL DEFAULT 1,
    config_json JSON NULL,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

CREATE TABLE IF NOT EXISTS app_settings (
    id INT AUTO_INCREMENT PRIMARY KEY,
    setting_key VARCHAR(100) NOT NULL UNIQUE,
    setting_value TEXT NULL,
    updated_at DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);

-- Optional defaults (safe to re-run)
INSERT INTO app_settings (setting_key, setting_value)
VALUES
    ('about_text', 'GetHost helps resolve hosts and monitor endpoint availability.'),
    ('contact_email', 'support@gethost.local'),
    ('contact_telegram', ''),
    ('contact_github', 'https://github.com/metr0n0m/gethost_hostmon')
ON DUPLICATE KEY UPDATE setting_value = VALUES(setting_value), updated_at = CURRENT_TIMESTAMP;

